const a93_0xb78c=['tag','musicDisabledPublic','getSongInfo','alt_title','info','user','type','apply','--format=bestaudio[protocol^=http]','dispatcherFinishHandler','textChannel','--no-cache-dir','filter','Constants','finish','join','--quiet','--force-ipv4','has','members','play','getString','musicDirectory','Artist','queue','COLORS','mkdir','document','keepAlive','errors','./music/','leave','--youtube-skip-dash-manifest','streamEndHandler','setActivity','presence','track','url','promises','href','getInfo','guild','unspeakable','catch','exports','../../utils/constants','voiceChannel','isPublicBastion','error','voice','artist','repeat','channel','PINK','--no-warnings','client','setDeaf','play\x20--link\x20https://www.youtube.com/watch?v=dQw4w9WgXcQ','creator','author','It\x20allows\x20you\x20to\x20play\x20a\x20music\x20in\x20the\x20server,\x20from\x20the\x20given\x20queury\x20or\x20from\x20any\x20supported\x20source.','Logger','startStreamDispatcher','configurations','activity','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','history','pipe','RED','DiscordError','connection','streamInfoHandler','play\x20Remember\x20The\x20Name\x20by\x20Ed\x20Sheeran','album','get','link','youtube-dl','--ignore-errors','isMusicMaster','locale','Up\x20Next','music','\x20â€¢\x20','send','duration','cache','name','test','Stopping\x20Playback','uploader','@bastion/tesseract','voiceChannelId','rmdir','INVALID_COMMAND_SYNTAX','--no-playlist','fulltitle','joinable','textChannelId','thumbnail','end','Album','.mp3','ytsearch:','playing','constructor','ArgumentTypes','--referer=https://bastion.traction.one','language','BASTION_ERROR_TYPE','push','member','createWriteStream','length','--geo-bypass-country=US','channels','exec','URL','uuid'];(function(_0x59265a,_0xb78cbb){const _0x55da11=function(_0x428821){while(--_0x428821){_0x59265a['push'](_0x59265a['shift']());}},_0x3d5eca=function(){const _0x1c9fec={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5538f5,_0x102ae0,_0x22461e,_0x51cd99){_0x51cd99=_0x51cd99||{};let _0x238ed8=_0x102ae0+'='+_0x22461e,_0x3b6c3d=0x0;for(let _0x4b744f=0x0,_0x511e6b=_0x5538f5['length'];_0x4b744f<_0x511e6b;_0x4b744f++){const _0x2edc21=_0x5538f5[_0x4b744f];_0x238ed8+=';\x20'+_0x2edc21;const _0xf10551=_0x5538f5[_0x2edc21];_0x5538f5['push'](_0xf10551),_0x511e6b=_0x5538f5['length'],_0xf10551!==!![]&&(_0x238ed8+='='+_0xf10551);}_0x51cd99['cookie']=_0x238ed8;},'removeCookie':function(){return'dev';},'getCookie':function(_0x44ebe8,_0x3f1629){_0x44ebe8=_0x44ebe8||function(_0x518b9e){return _0x518b9e;};const _0x3c02f7=_0x44ebe8(new RegExp('(?:^|;\x20)'+_0x3f1629['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0xeccf85=function(_0xcf0fba,_0x4fa576){_0xcf0fba(++_0x4fa576);};return _0xeccf85(_0x55da11,_0xb78cbb),_0x3c02f7?decodeURIComponent(_0x3c02f7[0x1]):undefined;}},_0x35a705=function(){const _0x558cfc=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x558cfc['test'](_0x1c9fec['removeCookie']['toString']());};_0x1c9fec['updateCookie']=_0x35a705;let _0x5cb998='';const _0x4573cc=_0x1c9fec['updateCookie']();if(!_0x4573cc)_0x1c9fec['setCookie'](['*'],'counter',0x1);else _0x4573cc?_0x5cb998=_0x1c9fec['getCookie'](null,'counter'):_0x1c9fec['removeCookie']();};_0x3d5eca();}(a93_0xb78c,0x1da));const a93_0x55da=function(_0x59265a,_0xb78cbb){_0x59265a=_0x59265a-0x0;let _0x55da11=a93_0xb78c[_0x59265a];return _0x55da11;};const a93_0x22461e=function(){let _0x3015cd=!![];return function(_0x34018e,_0x581b84){const _0x30278e=_0x3015cd?function(){if(_0x581b84){const _0x4bb59f=_0x581b84[a93_0x55da('0x5')](_0x34018e,arguments);return _0x581b84=null,_0x4bb59f;}}:function(){};return _0x3015cd=![],_0x30278e;};}(),a93_0x102ae0=a93_0x22461e(this,function(){const _0x466e66=function(){const _0x4ad9ef=_0x466e66[a93_0x55da('0x66')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor'](a93_0x55da('0x3f'));return!_0x4ad9ef[a93_0x55da('0x55')](a93_0x102ae0);};return _0x466e66();});a93_0x102ae0();'use strict';const fs=require('fs'),tesseract_1=require(a93_0x55da('0x58')),youtube=require(a93_0x55da('0x4a')),uuid_1=require(a93_0x55da('0x73')),constants=require(a93_0x55da('0x2b')),errors=require('../../utils/errors');module[a93_0x55da('0x2a')]=class Play extends tesseract_1['Command']{constructor(){super('play',{'description':a93_0x55da('0x3a'),'triggers':[],'arguments':{'alias':{'link':'l'},'coerce':{'link':tesseract_1[a93_0x55da('0xb')][a93_0x55da('0x67')][a93_0x55da('0x72')]}},'scope':a93_0x55da('0x27'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[],'syntax':[a93_0x55da('0x46'),a93_0x55da('0x37')]}),this[a93_0x55da('0x45')]=(_0x1f48ae,_0x2162fa)=>{const _0x4b9b85=_0x2162fa['id'],_0x58ec3e=_0x2162fa[a93_0x55da('0x22')]||_0x2162fa['title']||_0x2162fa[a93_0x55da('0x5d')]||_0x2162fa[a93_0x55da('0x1')],_0x3f7cc8=_0x2162fa[a93_0x55da('0x47')],_0x1247ec=_0x2162fa[a93_0x55da('0x30')]||_0x2162fa[a93_0x55da('0x38')]||_0x2162fa[a93_0x55da('0x57')],_0x52ae2c=_0x2162fa[a93_0x55da('0x52')],_0x3f82af=_0x2162fa[a93_0x55da('0x60')],_0x3f52d6=_0x2162fa['requester'];_0x1f48ae[a93_0x55da('0x4f')][a93_0x55da('0x16')][a93_0x55da('0x6b')]({'id':_0x4b9b85,'track':_0x58ec3e,'album':_0x3f7cc8,'artist':_0x1247ec,'duration':_0x52ae2c,'thumbnail':_0x3f82af,'requester':_0x3f52d6});const _0x38ffae=[];_0x3f7cc8&&_0x38ffae[a93_0x55da('0x6b')]({'name':a93_0x55da('0x62'),'value':_0x3f7cc8,'inline':!![]}),_0x1247ec&&_0x38ffae[a93_0x55da('0x6b')]({'name':a93_0x55da('0x15'),'value':_0x1247ec,'inline':!![]}),_0x1f48ae[a93_0x55da('0x4f')]['textChannel']['send']({'embed':{'color':tesseract_1[a93_0x55da('0xb')][a93_0x55da('0x17')]['PINK'],'title':'Added\x20to\x20Queue','description':_0x58ec3e,'fields':_0x38ffae,'thumbnail':{'url':_0x3f82af},'footer':{'text':(_0x1f48ae[a93_0x55da('0x4f')]['queue'][a93_0x55da('0x6e')]?'#'+(_0x1f48ae['music'][a93_0x55da('0x16')][a93_0x55da('0x6e')]-0x1):a93_0x55da('0x4e'))+(a93_0x55da('0x50')+_0x52ae2c+a93_0x55da('0x50')+(_0x1f48ae[a93_0x55da('0x11')][a93_0x55da('0x53')][a93_0x55da('0x48')](_0x3f52d6)[a93_0x55da('0x3')]['tag']||_0x3f52d6))}}})[a93_0x55da('0x29')](()=>{});},this['streamEndHandler']=_0x4914b4=>{!_0x4914b4[a93_0x55da('0x4f')][a93_0x55da('0x65')]&&this[a93_0x55da('0x3c')](_0x4914b4);},this['startStreamDispatcher']=_0x8b3150=>{if(_0x8b3150[a93_0x55da('0x4f')][a93_0x55da('0x16')][a93_0x55da('0x6e')]){const _0x48e6da=_0x8b3150[a93_0x55da('0x4f')]['queue'][0x0],_0x4e7abf=[];_0x48e6da[a93_0x55da('0x47')]&&_0x4e7abf['push']({'name':'Album','value':_0x48e6da[a93_0x55da('0x47')],'inline':!![]});_0x48e6da['artist']&&_0x4e7abf['push']({'name':a93_0x55da('0x15'),'value':_0x48e6da[a93_0x55da('0x30')],'inline':!![]});_0x8b3150['music'][a93_0x55da('0x8')]['send']({'embed':{'color':tesseract_1[a93_0x55da('0xb')][a93_0x55da('0x17')][a93_0x55da('0x33')],'title':'Playing','description':_0x48e6da[a93_0x55da('0x22')],'fields':_0x4e7abf,'thumbnail':{'url':_0x48e6da[a93_0x55da('0x60')]},'footer':{'text':_0x48e6da['duration']+a93_0x55da('0x50')+(_0x8b3150[a93_0x55da('0x11')]['cache'][a93_0x55da('0x48')](_0x48e6da['requester'])['user'][a93_0x55da('0x74')]||_0x48e6da['requester'])}}})[a93_0x55da('0x29')](()=>{}),_0x8b3150['music'][a93_0x55da('0x65')]=!![];const _0x5118b0=_0x8b3150[a93_0x55da('0x2f')]&&_0x8b3150[a93_0x55da('0x2f')]['connection'][a93_0x55da('0x12')](this['musicDirectory']+_0x8b3150['id']+'/'+_0x48e6da['id']+'.mp3');this[a93_0x55da('0x35')]['configurations'][a93_0x55da('0x4f')]&&this[a93_0x55da('0x35')][a93_0x55da('0x3d')][a93_0x55da('0x4f')]['activity']&&this['client'][a93_0x55da('0x3')][a93_0x55da('0x20')]({'name':_0x48e6da[a93_0x55da('0x22')],'type':'LISTENING'})[a93_0x55da('0x29')](()=>{}),_0x5118b0['on'](a93_0x55da('0xc'),()=>this['dispatcherFinishHandler'](_0x8b3150)),_0x5118b0['on'](a93_0x55da('0x2e'),_0x31bd7e=>{tesseract_1['Logger'][a93_0x55da('0x2e')](_0x31bd7e),this['dispatcherFinishHandler'](_0x8b3150);});}else _0x8b3150[a93_0x55da('0x4f')][a93_0x55da('0x16')]=[],_0x8b3150['music']['history']=[],fs[a93_0x55da('0x24')][a93_0x55da('0x5a')](this['musicDirectory']+_0x8b3150['id'],{'recursive':!![]})['catch'](()=>{}),this[a93_0x55da('0x35')][a93_0x55da('0x3d')][a93_0x55da('0x4f')]&&this['client'][a93_0x55da('0x3d')]['music'][a93_0x55da('0x3e')]&&this['client'][a93_0x55da('0x3')][a93_0x55da('0x20')](this[a93_0x55da('0x35')][a93_0x55da('0x3d')][a93_0x55da('0x21')][a93_0x55da('0x3e')])['catch'](()=>{}),!_0x8b3150['document'][a93_0x55da('0x4f')][a93_0x55da('0x1a')]&&(_0x8b3150[a93_0x55da('0x2f')]&&_0x8b3150[a93_0x55da('0x2f')][a93_0x55da('0x32')][a93_0x55da('0x1d')]()),_0x8b3150[a93_0x55da('0x4f')][a93_0x55da('0x8')][a93_0x55da('0x51')]({'embed':{'color':tesseract_1[a93_0x55da('0xb')]['COLORS']['PINK'],'title':a93_0x55da('0x56')}})['catch'](()=>{});},this[a93_0x55da('0x7')]=_0x5bd6fc=>{_0x5bd6fc[a93_0x55da('0x4f')][a93_0x55da('0x65')]=![],_0x5bd6fc[a93_0x55da('0x4f')]['skipVotes']=[],_0x5bd6fc['music'][a93_0x55da('0x16')]['length']&&_0x5bd6fc[a93_0x55da('0x4f')][a93_0x55da('0x40')]['push'](_0x5bd6fc[a93_0x55da('0x4f')]['queue']['shift']()),!_0x5bd6fc['music'][a93_0x55da('0x16')][a93_0x55da('0x6e')]&&_0x5bd6fc['music'][a93_0x55da('0x31')]&&(_0x5bd6fc['music'][a93_0x55da('0x16')]=_0x5bd6fc[a93_0x55da('0x4f')][a93_0x55da('0x40')],_0x5bd6fc['music'][a93_0x55da('0x40')]=[]),this['startStreamDispatcher'](_0x5bd6fc);},this[a93_0x55da('0x71')]=async(_0xe020ec,_0x764c1)=>{const _0x4646b3=_0xe020ec[a93_0x55da('0x27')];if(!_0x4646b3[a93_0x55da('0x19')][a93_0x55da('0x4f')]||!_0x4646b3[a93_0x55da('0x19')]['music']['enabled'])return await _0xe020ec[a93_0x55da('0x32')][a93_0x55da('0x51')]({'embed':{'color':tesseract_1['Constants'][a93_0x55da('0x17')]['RED'],'description':this[a93_0x55da('0x35')][a93_0x55da('0x4d')]['getString'](_0xe020ec[a93_0x55da('0x27')]['document'][a93_0x55da('0x69')],'errors',constants[a93_0x55da('0x2d')](_0xe020ec[a93_0x55da('0x39')])?a93_0x55da('0x75'):'musicDisabled')}})['catch'](()=>{});const _0x63077e=_0x764c1['_'][a93_0x55da('0xd')]('\x20'),_0x4f0b51=_0x63077e[a93_0x55da('0x6e')]?await this[a93_0x55da('0x0')](_0x63077e):null,_0x3327ed=_0x764c1[a93_0x55da('0x49')]?_0x764c1[a93_0x55da('0x49')][a93_0x55da('0x25')]:_0x4f0b51?_0x4f0b51['webpage_url']||_0x4f0b51[a93_0x55da('0x23')]:null;if(!_0x3327ed)throw new errors[(a93_0x55da('0x43'))](errors[a93_0x55da('0x6a')][a93_0x55da('0x5b')],this['name']);_0x4646b3['music'][a93_0x55da('0x8')]=_0xe020ec[a93_0x55da('0x27')][a93_0x55da('0x70')][a93_0x55da('0x53')][a93_0x55da('0x10')](_0x4646b3[a93_0x55da('0x19')]['music'][a93_0x55da('0x5f')])?_0xe020ec[a93_0x55da('0x27')]['channels'][a93_0x55da('0x53')]['get'](_0x4646b3[a93_0x55da('0x19')]['music'][a93_0x55da('0x5f')]):_0xe020ec['channel'],_0x4646b3[a93_0x55da('0x4f')][a93_0x55da('0x2c')]=_0xe020ec[a93_0x55da('0x27')][a93_0x55da('0x2f')]&&_0xe020ec[a93_0x55da('0x27')][a93_0x55da('0x2f')][a93_0x55da('0x44')]?_0xe020ec[a93_0x55da('0x27')]['voice'][a93_0x55da('0x32')]:_0xe020ec[a93_0x55da('0x27')][a93_0x55da('0x70')][a93_0x55da('0x53')][a93_0x55da('0xa')](_0x1485f2=>_0x1485f2[a93_0x55da('0x4')]===a93_0x55da('0x2f'))[a93_0x55da('0x10')](_0x4646b3[a93_0x55da('0x19')][a93_0x55da('0x4f')][a93_0x55da('0x59')])?_0xe020ec[a93_0x55da('0x27')][a93_0x55da('0x70')][a93_0x55da('0x53')]['filter'](_0x4d4d0f=>_0x4d4d0f[a93_0x55da('0x4')]==='voice')[a93_0x55da('0x48')](_0x4646b3[a93_0x55da('0x19')][a93_0x55da('0x4f')]['voiceChannelId']):_0xe020ec[a93_0x55da('0x6c')][a93_0x55da('0x4c')]()?_0xe020ec[a93_0x55da('0x6c')][a93_0x55da('0x2f')][a93_0x55da('0x32')]:null;if(!_0x4646b3[a93_0x55da('0x4f')]['voiceChannel'])return await _0xe020ec[a93_0x55da('0x32')][a93_0x55da('0x51')]({'embed':{'color':tesseract_1[a93_0x55da('0xb')][a93_0x55da('0x17')][a93_0x55da('0x42')],'description':this[a93_0x55da('0x35')]['locale'][a93_0x55da('0x13')](_0xe020ec[a93_0x55da('0x27')]['document']['language'],'errors',_0xe020ec['member'][a93_0x55da('0x4c')]()?'noMusicChannelsAsOwner':'noMusicChannels')}})[a93_0x55da('0x29')](()=>{});if(!_0x4646b3[a93_0x55da('0x4f')][a93_0x55da('0x2c')][a93_0x55da('0x5e')])return await _0xe020ec[a93_0x55da('0x32')][a93_0x55da('0x51')]({'embed':{'color':tesseract_1[a93_0x55da('0xb')]['COLORS'][a93_0x55da('0x42')],'description':this[a93_0x55da('0x35')]['locale'][a93_0x55da('0x13')](_0xe020ec[a93_0x55da('0x27')][a93_0x55da('0x19')]['language'],'errors','unjoinable',_0x4646b3[a93_0x55da('0x4f')][a93_0x55da('0x2c')][a93_0x55da('0x54')])}})[a93_0x55da('0x29')](()=>{});if(!_0x4646b3[a93_0x55da('0x4f')]['voiceChannel']['speakable'])return await _0xe020ec[a93_0x55da('0x32')][a93_0x55da('0x51')]({'embed':{'color':tesseract_1[a93_0x55da('0xb')][a93_0x55da('0x17')][a93_0x55da('0x42')],'description':this['client']['locale'][a93_0x55da('0x13')](_0xe020ec['guild']['document'][a93_0x55da('0x69')],'errors',a93_0x55da('0x28'),_0x4646b3['music'][a93_0x55da('0x2c')][a93_0x55da('0x54')])}})[a93_0x55da('0x29')](()=>{});const _0xa1bf33=await _0x4646b3[a93_0x55da('0x4f')][a93_0x55da('0x2c')][a93_0x55da('0xd')]();_0xa1bf33['on'](a93_0x55da('0x2e'),tesseract_1[a93_0x55da('0x3b')][a93_0x55da('0x2e')]),_0xa1bf33['on']('failed',tesseract_1[a93_0x55da('0x3b')]['error']),_0xe020ec[a93_0x55da('0x27')]['me'][a93_0x55da('0x2f')]['setMute'](![])[a93_0x55da('0x29')](()=>{}),_0xe020ec['guild']['me'][a93_0x55da('0x2f')][a93_0x55da('0x36')](!![])[a93_0x55da('0x29')](()=>{});const _0x5bdf6b=uuid_1['v4'](),_0x4708f4=youtube(_0x3327ed,[a93_0x55da('0x4b'),a93_0x55da('0xf'),'--geo-bypass-country=US','--no-playlist',a93_0x55da('0x9'),'--quiet','--no-warnings','--user-agent=Mozilla/5.0\x20(Macintosh;\x20Intel\x20Mac\x20OS\x20X\x2010_15_0)\x20AppleWebKit/604.1\x20(KHTML,\x20like\x20Gecko)\x20Version/13.0.4\x20Safari/604.1',a93_0x55da('0x68'),a93_0x55da('0x6'),a93_0x55da('0x1e')],{});_0x4708f4['on'](a93_0x55da('0x2'),_0x5b0b35=>this[a93_0x55da('0x45')](_0x4646b3,{..._0x5b0b35,'id':_0x5bdf6b,'requester':_0xe020ec[a93_0x55da('0x39')]['id']})),_0x4708f4['on'](a93_0x55da('0x61'),()=>this[a93_0x55da('0x1f')](_0x4646b3)),_0x4708f4['on'](a93_0x55da('0x2e'),()=>{_0xe020ec[a93_0x55da('0x32')][a93_0x55da('0x51')]({'embed':{'color':tesseract_1[a93_0x55da('0xb')][a93_0x55da('0x17')][a93_0x55da('0x42')],'description':this[a93_0x55da('0x35')][a93_0x55da('0x4d')]['getString'](_0xe020ec[a93_0x55da('0x27')]['document'][a93_0x55da('0x69')],a93_0x55da('0x1b'),'musicDownloadError')}})[a93_0x55da('0x29')](()=>{});}),await fs['promises'][a93_0x55da('0x18')](this[a93_0x55da('0x14')]+_0xe020ec[a93_0x55da('0x27')]['id']+'/',{'recursive':!![]})[a93_0x55da('0x29')](tesseract_1[a93_0x55da('0x3b')][a93_0x55da('0x2e')]),_0x4708f4[a93_0x55da('0x41')](fs[a93_0x55da('0x6d')](this[a93_0x55da('0x14')]+_0xe020ec['guild']['id']+'/'+_0x5bdf6b+a93_0x55da('0x63')));},this['musicDirectory']=a93_0x55da('0x1c');}[a93_0x55da('0x0')](_0xf9cd78){return new Promise((_0x3f2f61,_0x23d354)=>youtube[a93_0x55da('0x26')](a93_0x55da('0x64')+_0xf9cd78,[a93_0x55da('0x4b'),'--force-ipv4',a93_0x55da('0x6f'),a93_0x55da('0x5c'),'--no-cache-dir',a93_0x55da('0xe'),a93_0x55da('0x34'),'--user-agent=Mozilla/5.0\x20(Macintosh;\x20Intel\x20Mac\x20OS\x20X\x2010_15_0)\x20AppleWebKit/604.1\x20(KHTML,\x20like\x20Gecko)\x20Version/13.0.4\x20Safari/604.1',a93_0x55da('0x68'),a93_0x55da('0x6'),'--youtube-skip-dash-manifest'],(_0x473357,_0x4dd529)=>{if(_0x473357)return _0x23d354(_0x473357);return _0x3f2f61(_0x4dd529);}));}};