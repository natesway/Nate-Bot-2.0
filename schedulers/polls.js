const a197_0x27f4=['POLL\x20ENDED','COLORS','users','catch','constructor','length','channels','_id','Ended','SOMEWHAT_DARK','guilds','edit','filter','apply','return\x20/\x22\x20+\x20this\x20+\x20\x22/','default','then','Logger','exports','slice','map','test','guild','\x20votes\x20(','error','embeds','title','cache','size','readyTimestamp','polls','deleteMany','messages','has','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','reactions','@bastion/tesseract','exec','client','get','name','fields','channel'];(function(_0x1bd41e,_0x27f4b0){const _0x111ac4=function(_0x239b12){while(--_0x239b12){_0x1bd41e['push'](_0x1bd41e['shift']());}},_0x1978d6=function(){const _0x33ff6c={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x40100c,_0x51f503,_0x175fc3,_0x17ec03){_0x17ec03=_0x17ec03||{};let _0x1b6420=_0x51f503+'='+_0x175fc3,_0x475ffa=0x0;for(let _0x4503d9=0x0,_0x2ca2c9=_0x40100c['length'];_0x4503d9<_0x2ca2c9;_0x4503d9++){const _0x323281=_0x40100c[_0x4503d9];_0x1b6420+=';\x20'+_0x323281;const _0xc6d00f=_0x40100c[_0x323281];_0x40100c['push'](_0xc6d00f),_0x2ca2c9=_0x40100c['length'],_0xc6d00f!==!![]&&(_0x1b6420+='='+_0xc6d00f);}_0x17ec03['cookie']=_0x1b6420;},'removeCookie':function(){return'dev';},'getCookie':function(_0x33506e,_0x4b9706){_0x33506e=_0x33506e||function(_0x328303){return _0x328303;};const _0xc1cf02=_0x33506e(new RegExp('(?:^|;\x20)'+_0x4b9706['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x492e94=function(_0x4a5ebf,_0xfdbb09){_0x4a5ebf(++_0xfdbb09);};return _0x492e94(_0x111ac4,_0x27f4b0),_0xc1cf02?decodeURIComponent(_0xc1cf02[0x1]):undefined;}},_0x44dd2f=function(){const _0x227708=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x227708['test'](_0x33ff6c['removeCookie']['toString']());};_0x33ff6c['updateCookie']=_0x44dd2f;let _0x36f642='';const _0x4147fe=_0x33ff6c['updateCookie']();if(!_0x4147fe)_0x33ff6c['setCookie'](['*'],'counter',0x1);else _0x4147fe?_0x36f642=_0x33ff6c['getCookie'](null,'counter'):_0x33ff6c['removeCookie']();};_0x1978d6();}(a197_0x27f4,0xd8));const a197_0x111a=function(_0x1bd41e,_0x27f4b0){_0x1bd41e=_0x1bd41e-0x0;let _0x111ac4=a197_0x27f4[_0x1bd41e];return _0x111ac4;};const a197_0x175fc3=function(){let _0xda6dd8=!![];return function(_0x44f07d,_0x7d6ce7){const _0x37c8ef=_0xda6dd8?function(){if(_0x7d6ce7){const _0x3d652d=_0x7d6ce7[a197_0x111a('0xc')](_0x44f07d,arguments);return _0x7d6ce7=null,_0x3d652d;}}:function(){};return _0xda6dd8=![],_0x37c8ef;};}(),a197_0x51f503=a197_0x175fc3(this,function(){const _0x21fcdd=function(){const _0x408b13=_0x21fcdd[a197_0x111a('0x3')](a197_0x111a('0xd'))()[a197_0x111a('0x3')](a197_0x111a('0x21'));return!_0x408b13[a197_0x111a('0x14')](a197_0x51f503);};return _0x21fcdd();});a197_0x51f503();'use strict';const tesseract_1=require(a197_0x111a('0x23')),Poll_1=require('../models/Poll');module[a197_0x111a('0x11')]=class PollScheduler extends tesseract_1['Scheduler']{constructor(){super(a197_0x111a('0x1d'),{'cronTime':'0\x20*/15\x20*\x20*\x20*\x20*'}),this[a197_0x111a('0x24')]=async()=>{try{if(!this[a197_0x111a('0x25')][a197_0x111a('0x1c')])return;if(!this[a197_0x111a('0x25')][a197_0x111a('0x9')][a197_0x111a('0x1a')]['size'])return;const _0x408c7e=await Poll_1[a197_0x111a('0xe')]['find']({'$or':this['client'][a197_0x111a('0x9')][a197_0x111a('0x1a')]['map'](_0x37b72b=>({'guild':_0x37b72b['id']})),'ends':{'$lte':new Date()}}),_0x34a1ba=[];for(const _0x2907f3 of _0x408c7e){const _0x26310b=this[a197_0x111a('0x25')]['guilds'][a197_0x111a('0x1a')][a197_0x111a('0x26')](_0x2907f3[a197_0x111a('0x15')]);if(_0x26310b['channels'][a197_0x111a('0x1a')][a197_0x111a('0x20')](_0x2907f3['channel'])){const _0x368acb=_0x26310b[a197_0x111a('0x5')][a197_0x111a('0x1a')][a197_0x111a('0x26')](_0x2907f3[a197_0x111a('0x29')]),_0x4820de=await _0x368acb[a197_0x111a('0x1f')]['fetch'](_0x2907f3[a197_0x111a('0x6')])[a197_0x111a('0x2')](()=>{});if(!_0x4820de)continue;const _0x4a910a=_0x4820de[a197_0x111a('0x18')][0x0][a197_0x111a('0x28')]['map'](_0x283136=>_0x283136['value']),_0x1f7258=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],_0x2dfbce={};let _0x56ce5f=0x0;for(const _0x17da94 in _0x1f7258[a197_0x111a('0x12')](0x0,_0x4a910a[a197_0x111a('0x4')])){if(_0x4820de[a197_0x111a('0x22')]['cache'][a197_0x111a('0x20')](_0x1f7258[_0x17da94])){await _0x4820de['reactions'][a197_0x111a('0x1a')][a197_0x111a('0x26')](_0x1f7258[_0x17da94])[a197_0x111a('0x1')]['fetch']()[a197_0x111a('0x2')](()=>{});const _0x56e9d5=_0x4820de[a197_0x111a('0x22')][a197_0x111a('0x1a')][a197_0x111a('0x26')](_0x1f7258[_0x17da94])[a197_0x111a('0x1')]['cache'][a197_0x111a('0xb')](_0x5dff82=>!_0x5dff82['bot'])[a197_0x111a('0x1b')];_0x2dfbce[_0x1f7258[_0x17da94]]=_0x56e9d5,_0x56ce5f+=_0x56e9d5;}}await _0x4820de[a197_0x111a('0xa')]({'embed':{'color':tesseract_1['Constants'][a197_0x111a('0x0')][a197_0x111a('0x8')],'author':{'name':a197_0x111a('0x2a')},'title':_0x4820de[a197_0x111a('0x18')][0x0][a197_0x111a('0x19')],'fields':_0x4820de['embeds'][0x0][a197_0x111a('0x28')][a197_0x111a('0x13')](_0x4afe29=>({'name':_0x4afe29[a197_0x111a('0x27')]+'\x20'+_0x4afe29['value'],'value':(_0x2dfbce[_0x4afe29[a197_0x111a('0x27')]]||0x0)+'\x20/\x20'+_0x56ce5f+a197_0x111a('0x16')+(_0x2dfbce[_0x4afe29[a197_0x111a('0x27')]]?_0x2dfbce[_0x4afe29['name']]/_0x56ce5f*0x64:0x0)['toFixed'](0x2)+'%)'})),'footer':{'text':a197_0x111a('0x7')},'timestamp':new Date()}})[a197_0x111a('0xf')](()=>{_0x34a1ba['push'](_0x4820de['id']);})['catch'](()=>{});}}_0x34a1ba[a197_0x111a('0x4')]&&await Poll_1['default'][a197_0x111a('0x1e')]({'$or':_0x34a1ba[a197_0x111a('0x13')](_0x253091=>({'_id':_0x253091}))})[a197_0x111a('0x2')](()=>{});}catch(_0x21adf2){tesseract_1[a197_0x111a('0x10')][a197_0x111a('0x17')](_0x21adf2);}};}};